YUI.add("moodle-availability_examus-form",function(B,e){M.availability_examus=M.availability_examus||{},M.availability_examus.form=B.Object(M.core_availability.plugin),M.availability_examus.form.rules=null,M.availability_examus.form.initInner=function(e,i,n,a){this.rules=e,this.groups=i,this.warnings=n,this.scoring=a},M.availability_examus.form.instId=0,M.availability_examus.form.getNode=function(e){var n,i,a,t,s,o,l,r,u,c,d,m,p,g,f,b,v,h,_,y,x,F,k,w,H,L,C,q,I,N,T,R,A,O,P,D,S,E,U;function V(e,i){return i=i||"availability_examus",M.util.get_string(e,i)}function Y(e){var i=V("showmore","core_form"),n=V("showless","core_form");return'<a href="#" class="examus-moreless" data-more="'+i+'" data-less="'+n+'">'+i+'</a><div class="hidden col-md-12">'+e+"</div>"}function j(e,i,n,a){var t=a?10:5,a=a?10:7;return'<span class="availability-group form-group mb-2"><div class="col-md-'+t+' col-form-label d-flex pb-0 pr-md-0">  <label for="'+e+'">'+i+'</label></div><div class="col-md-'+a+' form-inline align-items-start felement">'+n+"</div></span>"}function $(e){setTimeout(e,0)}function z(e){1==e?(I.addClass("btn-primary"),I.removeClass("btn-secondary"),N.addClass("btn-secondary"),N.removeClass("btn-primary"),T.removeClass("hidden"),R.addClass("hidden")):(N.addClass("btn-primary"),N.removeClass("btn-secondary"),I.addClass("btn-secondary"),I.removeClass("btn-primary"),T.addClass("hidden"),R.removeClass("hidden"))}for(g in M.availability_examus.form.instId+=1,s=(a="examus"+M.availability_examus.form.instId)+"_mode",o=a+"_schedulingRequired",l=a+"_autoRescheduling",r=a+"_isTrial",C=a+"_identification",u=a+"_customRules",c=a+"_noProtection",d=a+"_auxCamera",m=a+"userAgreement",t=j(t=a+"_duration",V("duration"),'<input type="text" name="duration" id="'+t+'" class="form-control">'),t=(t=(t=(t=(t=(t=(t=(t=(t+=j(s,V("mode"),'<select name="mode" id="'+s+'" class="custom-select">  <option value="normal">'+V("normal_mode")+'</option>  <option value="identification">'+V("identification_mode")+'</option>  <option value="olympics">'+V("olympics_mode")+'</option>  <option value="auto">'+V("auto_mode")+"</option></select>"))+j(C,V("identification"),'<select name="identification" id="'+C+'" class="custom-select">  <option value="passport">'+V("passport_identification")+'</option>  <option value="face">'+V("face_identification")+'</option>  <option value="face_and_passport">'+V("face_passport_identification")+'</option>  <option value="skip">'+V("skip_identification")+"</option></select>"))+j(o,V("scheduling_required"),'<input type="checkbox" name="scheduling_required" id="'+o+'" value="1">&nbsp;<label for="'+o+'">'+V("enable")+"</label> "))+j(l,V("auto_rescheduling"),'<input type="checkbox" name="auto_rescheduling" id="'+l+'" value="1">&nbsp;<label for="'+l+'">'+V("enable")+"</label> "))+j(r,V("is_trial"),'<input type="checkbox" name="istrial" id="'+r+'" value="1">&nbsp;<label for="'+r+'">'+V("enable")+"</label> "))+j(c,V("noprotection"),'<input type="checkbox" name="noprotection" id="'+c+'" value="1">&nbsp;<label for="'+c+'">'+V("enable")+"</label> "))+j(r,V("auxiliary_camera"),'<input type="checkbox" name="auxiliarycamera" id="'+d+'" value="1">&nbsp;<label for="'+d+'">'+V("enable")+"</label> "))+j(m,V("user_agreement_url"),'<input name="useragreementurl" id="'+m+'" class="form-control" value="" />'))+j(u,V("custom_rules"),'<textarea name="customrules" id="'+u+'" style="width: 100%" class="form-control"></textarea>'),p="",this.rules)p=(p+='<br><input type="checkbox" name="'+g+'" id="'+(f=a+"_"+g)+'" value="'+g+'" >&nbsp;')+'<label for="'+f+'" style="white-space: break-spaces">'+V(g)+"</label>";if(t+=j(null,V("rules"),'<div class="rules" style="white-space:nowrap">'+p+"</div>"),this.groups){for(v in b="",this.groups)h=this.groups[v].name,_=e.groups instanceof Array?e.groups:[],b+="<br><label><input value="+(a=parseInt(this.groups[v].id))+' type="checkbox" name=groups[] '+(-1<(_=_.map(function(e){return parseInt(e)})).indexOf(a)?"checked":"")+">&nbsp;"+h+"</label>";t+=j(null,V("select_groups"),'<div class="groups">'+b+"</div>")}for(x in y="",this.warnings)y=(y+='<input type="checkbox" name="'+x+'" id="'+(F=a+"_"+x)+'" value="'+x+'" >&nbsp;')+'<label for="'+F+'" style="white-space: break-spaces">'+V(x)+"</label><br>";for(w in k="",this.scoring)L='<input type="number" class="examus-scoring-input" value=""step="0.01" name="'+w+'" id="scoring_'+(H=a+"_"+w)+'" min="'+this.scoring[w].min+'" max="'+this.scoring[w].max+'">',k+=j(H,V("scoring_"+w),L);if(C="",C=(C+=j(null,V("visible_warnings"),'<div class="warnings" style="white-space: nowrap" >'+Y(y)+"</div>",!0))+j(null,V("visible_warnings"),Y(k),!0),(n=B.Node.create('<span class="availibility_examus-tabs" style="position:relative"></span>')).setHTML("<label><strong>"+V("title")+"</strong></label><br><br>"),q=B.Node.create('<div style="position:absolute; top: 0; right: 0;" class="availibility_examus-tab-btns"></div>').appendTo(n),I=B.Node.create('<a href="#" class="btn btn-primary">1</a>').appendTo(q),N=B.Node.create('<a href="#" class="btn btn-secondary">2</a>').appendTo(q),T=B.Node.create('<div class="tab_content">'+t+"</div>").appendTo(n),R=B.Node.create('<div class="tab_content hidden">'+C+"</div>").appendTo(n),e.creating&&(e.mode="normal",e.scheduling_required=!0),e.duration!==undefined&&n.one("input[name=duration]").set("value",e.duration),e.mode!==undefined&&n.one("select[name=mode] option[value="+e.mode+"]").set("selected","selected"),e.identification!==undefined&&n.one("select[name=identification] option[value="+e.identification+"]").set("selected","selected"),e.auto_rescheduling!==undefined&&(i=e.auto_rescheduling?"checked":null,n.one("#"+l).set("checked",i)),e.noprotection!==undefined&&(i=e.noprotection?"checked":null,n.one("#"+c).set("checked",i)),e.istrial!==undefined&&(i=e.istrial?"checked":null,n.one("#"+r).set("checked",i)),e.auxiliarycamera!==undefined&&(i=e.auxiliarycamera?"checked":null,n.one("#"+d).set("checked",i)),e.scheduling_required!==undefined&&(
i=e.scheduling_required?"checked":null,n.one("#"+o).set("checked",i)),e.rules===undefined&&(e.rules=this.rules),e.warnings===undefined)e.warnings=this.warnings;else for(x in A=e.warnings,e.warnings=this.warnings,A)e.warnings[x]=A[x];for(O in e.rules)e.rules[O]&&(P=n.one(".rules input[name="+O+"]"))&&P.set("checked","checked");for(D in e.warnings)e.warnings[D]&&(S=n.one(".warnings input[name="+D+"]"))&&S.set("checked","checked");for(E in e.scoring=e.scoring||{},e.scoring)e.scoring[E]&&(U=n.one(".examus-scoring-input[name="+E+"]"))&&U.set("value",e.scoring[E]);return e.customrules!==undefined&&n.one("#"+u).set("value",e.customrules),e.useragreementurl!==undefined&&n.one("#"+m).set("value",e.useragreementurl),n.delegate("valuechange",function(){$(function(){M.core_availability.form.update()})},"input,textarea,select"),n.delegate("click",function(){$(function(){M.core_availability.form.update()})},"input[type=checkbox]"),n.delegate("valuechange",function(){var e,i;e=["normal","identification"],i=n.one("select[name=mode]").get("value").trim(),i=0<=e.indexOf(i),n.one("#"+o).set("checked",i)},"#"+s),I.on("click",function(e){e.preventDefault(),z(1)}),N.on("click",function(e){e.preventDefault(),z(2)}),n.delegate("click",function(e){var i;e.preventDefault(),e=e.target,i=e.next(),i.hasClass("hidden")?(i.removeClass("hidden"),e.setContent(e.getAttribute("data-less"))):(i.addClass("hidden"),e.setContent(e.getAttribute("data-more")))},".examus-moreless"),n},M.availability_examus.form.fillValue=function(n,e){var i,a,t;n.duration=e.one("input[name=duration]").get("value").trim(),n.mode=e.one("select[name=mode]").get("value").trim(),n.identification=e.one("select[name=identification]").get("value").trim(),n.auto_rescheduling=e.one("input[name=auto_rescheduling]").get("checked"),n.scheduling_required=e.one("input[name=scheduling_required]").get("checked"),n.istrial=e.one("input[name=istrial]").get("checked"),n.customrules=e.one("textarea[name=customrules]").get("value").trim(),n.noprotection=e.one("input[name=noprotection]").get("checked"),n.useragreementurl=e.one("input[name=useragreementurl]").get("value").trim(),n.auxiliarycamera=e.one("input[name=auxiliarycamera]").get("checked"),n.rules={},i=e.all(".rules input"),B.each(i,function(e){t=e.get("value"),!0===e.get("checked")?n.rules[t]=!0:n.rules[t]=!1}),n.warnings={},a=e.all(".warnings input"),B.each(a,function(e){t=e.get("value"),!0===e.get("checked")?n.warnings[t]=!0:n.warnings[t]=!1}),n.scoring={},a=e.all(".examus-scoring-input"),B.each(a,function(e){t=e.get("name");e=e.get("value").trim();0<e.length?n.scoring[t]=parseFloat(e):n.scoring[t]=null}),n.groups=[],i=e.all(".groups input"),B.each(i,function(e){var i=e.get("value");!0===e.get("checked")&&n.groups.push(i)})},M.availability_examus.form.fillErrors=function(e,i){var n={};this.fillValue(n,i),n.duration!==undefined&&new RegExp("^\\d+$").test(n.duration)&&n.duration%30==0||e.push("availability_examus:error_setduration")}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});